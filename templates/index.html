{% extends "base.html" %}

{% block title %}Inventario | Bridges{% endblock %}

{% block content %}
  <h2>Movimientos (Kardex)</h2>
  <form action="/agregar" method="post">
    <label for="nombre">Nombre:</label>
    <input type="text" id="nombre" name="nombre" required>

    <label for="cantidad">Cantidad:</label>
    <input type="number" id="cantidad" name="cantidad" required>

    <label for="categoria">Categoría:</label>
    <select id="categoria" name="categoria" required>
      <option value="Activo">Activo</option>
      <option value="Consumible">Consumible</option>
    </select>

    <button type="submit">Agregar</button>
  </form>

  <h2>Inventario Actual</h2>
  <table id="inventarioTabla">
    <thead>
      <tr>
        <th>Nombre</th>
        <th>Cantidad</th>
        <th>Categoría</th>
        <th>Consumo Estimado</th>
        {% if modo_admin %}<th>Acciones</th>{% endif %}
      </tr>
    </thead>
    <tbody>
      {% for item in inventario %}
      <tr>
        <td>{{ item.nombre }}</td>
        <td>{{ item.cantidad }}</td>
        <td>{{ item.categoria }}</td>
        <td>{{ item.consumo_estimado }}</td>
        {% if modo_admin %}
        <td>
          <form action="{{ url_for('eliminar_item_inventario', item_id=item.id) }}"
                method="post" style="display:inline;">
            <button type="submit"
                    onclick="return confirm('¿Eliminar &quot;{{ item.nombre }}&quot;? Esta acción no se puede deshacer.');">
              Eliminar
            </button>
          </form>
        </td>
        {% endif %}
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}

{% block scripts %}
<script>
  /* global $ */
  $(document).ready(function() {
    $('#inventarioTabla').DataTable({
      paging: true,
      searching: true,
      ordering: true,
      order: [[1, "desc"]],
      language: {
        search: "Buscar:",
        lengthMenu: "Mostrar _MENU_ registros por página",
        info: "Mostrando _START_ a _END_ de _TOTAL_ registros",
        paginate: {
          first: "Primero",
          last: "Último",
          next: "Siguiente",
          previous: "Anterior"
        }
      }
    });
  });
</script>
{% endblock %}
